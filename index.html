<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VM Agent - Bulk Update Visualization</title>
    <link rel="stylesheet" href="https://unpkg.com/@salesforce-ux/design-system@2.22.2/assets/styles/salesforce-lightning-design-system.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Initial Page - Agentforce Trigger Button -->
        <div class="page-content">
            <div class="agentforce-trigger">
                <button class="slds-button slds-button_brand" onclick="openAgentforce()">
                    <i class="fas fa-robot"></i>
                    Open VM Agent
                </button>
                <p class="slds-text-body_small slds-text-color_weak">
                    Click to analyze bulk update impact with VM Agent
                </p>
            </div>
        </div>

        <!-- Agentforce Modal -->
        <div class="slds-backdrop slds-backdrop_open" id="agentforceModal" style="display: none;">
            <div class="slds-modal slds-fade-in-open slds-modal_large agentforce-modal">
                <div class="slds-modal__container">
                    <!-- Modal Header -->
                    <div class="slds-modal__header agentforce-header">
                        <h2 class="slds-modal__title slds-hyphenate">
                            Preview Bulk Update
                        </h2>
                        <button class="slds-button slds-button_icon slds-modal__close" onclick="closeAgentforce()">
                            <i class="fas fa-times"></i>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                    </div>
                    
                    <!-- Modal Body - Main Content Area -->
                    <div class="slds-modal__content agentforce-content">
                        <!-- Visualization Area -->
                        <div class="visualization-area" id="visualizationArea">
                            <!-- Expand Chat Button (when collapsed) -->
                            <button class="slds-button slds-button_icon chat-expand-btn" id="chatExpandBtn" onclick="toggleChatPanel()" style="display: none;" title="Expand Chat">
                                <i class="fas fa-comments"></i>
                                <span class="slds-assistive-text">Expand Chat</span>
                            </button>
                            
                            <!-- Visualization Header -->
                            <div class="viz-header">
                                <div class="header-title-with-tooltip">
                                    <h3 class="slds-text-heading_medium">15 records will be updated</h3>
                                    <div class="tooltip-container">
                                        <button class="info-tooltip-trigger" aria-describedby="bulk-update-tooltip">
                                            <i class="fas fa-info-circle"></i>
                                        </button>
                                        <div class="custom-tooltip" id="bulk-update-tooltip" role="tooltip">
                                            <div class="tooltip-content">
                                                <div class="tooltip-title">15 records will be updated</div>
                                                <div class="tooltip-description">
                                                    Canceling this Volunteer Initiative will cascade to related records:
                                                    <ul>
                                                        <li><strong>Job Positions:</strong> All associated positions will be cancelled</li>
                                                        <li><strong>Job Shifts:</strong> All scheduled shifts will be removed</li>
                                                        <li><strong>Assignments:</strong> All volunteer assignments will be cancelled</li>
                                                    </ul>
                                                    This action cannot be undone.
                                                </div>
                                            </div>
                                            <div class="tooltip-arrow"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="viz-controls">
                                    <div class="slds-button-group" role="group">
                                        <button class="slds-button slds-button_neutral slds-button_first" id="treeViewBtn" onclick="switchView('tree')">
                                            <i class="fas fa-sitemap slds-m-right_x-small"></i>
                                            Tree View
                                        </button>
                                        <button class="slds-button slds-button_neutral slds-button_last" id="listViewBtn" onclick="switchView('list')">
                                            <i class="fas fa-list slds-m-right_x-small"></i>
                                            List View
                                        </button>
                                    </div>
                                    
                                    <div class="slds-button-group tree-controls" id="treeControls" role="group">
                                        <button class="slds-button slds-button_neutral slds-button_first" onclick="expandAll()">
                                            <i class="fas fa-expand-alt slds-m-right_x-small"></i>
                                            Expand All
                                        </button>
                                        <button class="slds-button slds-button_neutral slds-button_last" onclick="collapseAll()">
                                            <i class="fas fa-compress-alt slds-m-right_x-small"></i>
                                            Collapse All
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Visualization Content -->
                            <div class="viz-content">
                                <!-- Tree View -->
                                <div class="tree-view" id="treeView">
                                    <div class="tree-container">
                                        <div id="hierarchyTree"></div>
                                    </div>
                                </div>
                                
                                <!-- List View -->
                                <div class="list-view" id="listView" style="display: none;">
                                    <div class="slds-tabs_default">
                                        <ul class="slds-tabs_default__nav" role="tablist">
                                            <li class="slds-tabs_default__item slds-is-active" role="presentation">
                                                <a class="slds-tabs_default__link" href="#" onclick="switchTab('initiatives')" role="tab">
                                                    <i class="fas fa-heart slds-m-right_x-small"></i>
                                                    Volunteer Initiatives
                                                </a>
                                            </li>
                                            <li class="slds-tabs_default__item" role="presentation">
                                                <a class="slds-tabs_default__link" href="#" onclick="switchTab('positions')" role="tab">
                                                    <i class="fas fa-briefcase slds-m-right_x-small"></i>
                                                    Job Positions
                                                </a>
                                            </li>
                                            <li class="slds-tabs_default__item" role="presentation">
                                                <a class="slds-tabs_default__link" href="#" onclick="switchTab('shifts')" role="tab">
                                                    <i class="fas fa-clock slds-m-right_x-small"></i>
                                                    Job Shifts
                                                </a>
                                            </li>
                                            <li class="slds-tabs_default__item" role="presentation">
                                                <a class="slds-tabs_default__link" href="#" onclick="switchTab('assignments')" role="tab">
                                                    <i class="fas fa-users slds-m-right_x-small"></i>
                                                    Assignments
                                                </a>
                                            </li>
                                        </ul>
                                        <div class="tab-content-wrapper">
                                            <div id="initiativesList" class="slds-tabs_default__content slds-show"></div>
                                            <div id="positionsList" class="slds-tabs_default__content slds-hide"></div>
                                            <div id="shiftsList" class="slds-tabs_default__content slds-hide"></div>
                                            <div id="assignmentsList" class="slds-tabs_default__content slds-hide"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Collapsible Chat Panel -->
                        <div class="chat-panel" id="chatPanel">
                            <!-- Chat Panel Header -->
                            <div class="chat-panel-header">
                                <h3 class="slds-text-heading_small">Conversation</h3>
                                <button class="slds-button slds-button_icon chat-toggle" onclick="toggleChatPanel()" title="Collapse Chat">
                                    <i class="fas fa-chevron-right" id="chatToggleIcon"></i>
                                    <span class="slds-assistive-text">Toggle Chat Panel</span>
                                </button>
                            </div>
                            
                            <!-- Chat Messages -->
                            <div class="chat-messages" id="chatMessages">
                                <!-- Messages will be populated by JS -->
                            </div>
                            
                            <!-- Chat Input -->
                            <div class="chat-input-area">
                                <div class="slds-form-element">
                                    <div class="slds-form-element__control">
                                        <textarea class="slds-textarea chat-input" placeholder="Ask VM Agent a question..." rows="3" id="chatInput"></textarea>
                                    </div>
                                </div>
                                <div class="chat-input-actions">
                                    <button class="slds-button slds-button_brand" onclick="sendMessage()">
                                        <i class="fas fa-paper-plane slds-m-right_x-small"></i>
                                        Send
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Modal Footer -->
                    <div class="slds-modal__footer agentforce-footer">
                        <div class="footer-actions">
                            <button class="slds-button slds-button_neutral" onclick="closeAgentforce()">
                                Cancel
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html> 